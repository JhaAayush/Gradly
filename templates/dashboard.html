{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}
{% block content %}
<h1 class="text-3xl font-bold text-indigo-700 mb-6">Hello, {{ current_user.name }}</h1>

<div class="grid md:grid-cols-3 gap-6">
    <!-- Profile Card -->
<a href="{{ url_for('profile.view_profile', user_id=current_user.id) }}"
    class="block bg-white p-6 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300">
    <h2 class="text-xl font-semibold mb-4">Your Profile</h2>
    <p><strong>Roll No:</strong> {{ current_user.id }}</p>
    <p><strong>Email:</strong> {{ current_user.email }}</p>
    <p><strong>CGPA:</strong> {{ current_user.cgpa or 'N/A' }}</p>
</a>

    <!-- Tasks -->
<div class="bg-white p-6 rounded-xl shadow-lg">
    <h2 class="text-xl font-semibold mb-4">Your Tasks</h2>
    <ul class="space-y-2">
        {% for task in tasks %}
        <li class="flex justify-between items-center bg-gray-50 p-2 rounded">
            <div class="flex items-center space-x-2">
                <!-- Circle Checkbox -->
                <form method="POST" action="{{ url_for('tasks.toggle_task', task_id=task.id) }}">
                    <button type="submit" class="w-5 h-5 rounded-full border border-gray-400 flex items-center justify-center 
                           {% if task.is_done %}bg-green-500 border-green-500{% endif %}">
                        {% if task.is_done %}
                        <i class="fa fa-check text-white text-xs"></i>
                        {% endif %}
                    </button>
                </form>

                <!-- Task Title -->
                <div class="{% if task.is_done %}line-through text-gray-500{% endif %}">
                    {{ task.title }}<br>
                    <small class="text-gray-600">
                        Due: {{ task.due_date.strftime('%d %b %Y') if task.due_date else 'No deadline' }}
                    </small>
                </div>
            </div>

            <!-- Edit/Delete Buttons -->
            <div class="flex space-x-2">
                <a href="{{ url_for('tasks.edit_task', task_id=task.id) }}"
                    class="text-yellow-500 hover:text-yellow-600">
                    <i class="fa fa-pen"></i>
                </a>
                <form method="POST" action="{{ url_for('tasks.delete_task', task_id=task.id) }}">
                    <button type="submit" class="text-red-500 hover:text-red-600">
                        <i class="fa fa-trash"></i>
                    </button>
                </form>
            </div>
        </li>
        {% else %}
        <p class="text-gray-500">No tasks yet.</p>
        {% endfor %}
    </ul>

    <!-- Add Task Form -->
    <form method="POST" class="mt-4">
        {{ form.hidden_tag() }}
        {{ form.title(class="w-full p-2 border rounded-lg mb-2 focus:ring focus:ring-indigo-300") }}
        {{ form.due_date(class="w-full p-2 border rounded-lg mb-2 focus:ring focus:ring-indigo-300", type="date") }}
        {{ form.submit(class="mt-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700") }}
    </form>
</div>


    <!-- Upcoming Events -->
    <div class="bg-white p-6 rounded-xl shadow-lg">
        <h2 class="text-xl font-semibold mb-4">Upcoming Events</h2>
        <ul class="space-y-2">
            {% for event in events %}
            <li class="bg-gray-50 p-2 rounded">
                <strong>{{ event.title }}</strong> <br>
                <small>{{ event.date.strftime('%d %b %Y') }}</small>
            </li>
            {% else %}
            <p class="text-gray-500">No events listed.</p>
            {% endfor %}
        </ul>
    </div>
</div>
{% endblock %}