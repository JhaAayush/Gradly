{% extends "base.html" %}
{% block title %}{{ body.name }} Â· Dashboard{% endblock %}
{% block content %}
<div class="flex justify-between items-center mb-8">
    <div>
        <h1 class="text-4xl font-extrabold text-slate-800">{{ body.name }}</h1>
        <p class="text-slate-500">Management Dashboard</p>
    </div>
    <a href="{{ url_for('studentbody.view_body', body_id=body.id) }}"
        class="bg-white text-slate-700 px-4 py-2 rounded-full font-semibold text-sm border border-slate-200 hover:bg-slate-50 hover:border-slate-300 transition-all">
        View Public Page <i class="fa fa-arrow-right ml-2"></i>
    </a>
</div>

<div class="grid lg:grid-cols-5 gap-8">
    <div class="lg:col-span-2">
        <div class="bg-white/70 backdrop-blur-lg p-6 rounded-2xl shadow-2xl border border-slate-200 sticky top-24">
            <h2 class="text-2xl font-bold text-slate-800 mb-6 flex items-center gap-3"><i
                    class="fa fa-plus-circle text-pink-500"></i> Create New Event</h2>
            <form method="POST" enctype="multipart/form-data" class="space-y-4">
                {{ form.hidden_tag() }}
                <div>
                    {{ form.title.label(class="block text-sm font-semibold text-slate-600 mb-1") }}
                    {{ form.title(class="w-full p-2 bg-slate-100 rounded-lg focus:ring-2 focus:ring-pink-500") }}
                </div>
                <div>
                    {{ form.description.label(class="block text-sm font-semibold text-slate-600 mb-1") }}
                    {{ form.description(rows=4, class="w-full p-2 bg-slate-100 rounded-lg focus:ring-2
                    focus:ring-pink-500") }}
                </div>
                <div>
                    {{ form.date.label(class="block text-sm font-semibold text-slate-600 mb-1") }}
                    {{ form.date(class="w-full p-2 bg-slate-100 rounded-lg focus:ring-2 focus:ring-pink-500
                    text-slate-500", type="date") }}
                </div>
                <div>
                    {{ form.poster.label(class="block text-sm font-semibold text-slate-600 mb-1") }}
                    {{ form.poster(class="w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full
                    file:border-0 file:text-sm file:font-semibold file:bg-pink-50 file:text-pink-700
                    hover:file:bg-pink-100") }}
                </div>
                <div class="pt-2">
                    {{ form.submit(class="w-full bg-pink-600 text-white font-semibold py-3 rounded-lg hover:bg-pink-700
                    transition-all") }}
                </div>
            </form>
        </div>
    </div>

    <div class="lg:col-span-3">
        <div class="bg-white/70 backdrop-blur-lg p-6 rounded-2xl shadow-2xl border border-slate-200">
            <h2 class="text-2xl font-bold text-slate-800 mb-6 flex items-center gap-3"><i
                    class="fa fa-list-check text-pink-500"></i> Manage Events</h2>
            <div class="space-y-4">
                {% for ev in events %}
                <div
                    class="bg-slate-50/80 rounded-lg p-4 flex items-center justify-between gap-4 transition-shadow hover:shadow-md">
                    <div class="flex items-center gap-4">
                        {% if ev.poster %}
                        <img src="{{ url_for('static', filename=ev.poster) }}"
                            class="w-24 h-16 object-cover rounded-md flex-shrink-0" alt="Event Poster">
                        {% else %}
                        <div
                            class="w-24 h-16 bg-slate-200 rounded-md flex-shrink-0 flex items-center justify-center text-slate-400">
                            <i class="fa fa-image"></i></div>
                        {% endif %}
                        <div>
                            <p class="font-bold text-slate-800">{{ ev.title }}</p>
                            <p class="text-sm text-slate-500">{{ ev.date.strftime('%d %b %Y') if ev.date else 'No date'
                                }}</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-2 flex-shrink-0">
                        <a href="{{ url_for('studentbody.edit_event', body_id=body.id, event_id=ev.id) }}"
                            class="h-9 w-9 flex items-center justify-center rounded-full text-slate-500 hover:bg-yellow-100 hover:text-yellow-600 transition-colors"
                            title="Edit">
                            <i class="fa fa-pen text-sm"></i>
                        </a>
                        <form method="POST"
                            action="{{ url_for('studentbody.delete_event', body_id=body.id, event_id=ev.id) }}"
                            onsubmit="return confirm('Are you sure you want to delete this event?');">
                            <button type="submit"
                                class="h-9 w-9 flex items-center justify-center rounded-full text-slate-500 hover:bg-red-100 hover:text-red-600 transition-colors"
                                title="Delete">
                                <i class="fa fa-trash text-sm"></i>
                            </button>
                        </form>
                    </div>
                </div>
                {% else %}
                <p class="text-slate-500 text-center py-10">You haven't created any events yet.</p>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}